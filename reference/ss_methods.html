<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Single sample scoring methods — ss_methods • hacksig</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single sample scoring methods — ss_methods"><meta name="description" content="These are internal functions to compute single sample scores from a list of
gene signatures in three different ways:
combined z-score (Lee et al., 2008);
single sample GSEA (Barbie et al., 2009);
singscore (Foroutan et al., 2018).


compute_ssgsea() is called by hack_estimate() whereas all the three
methods are called by hack_sig()."><meta property="og:description" content="These are internal functions to compute single sample scores from a list of
gene signatures in three different ways:
combined z-score (Lee et al., 2008);
single sample GSEA (Barbie et al., 2009);
singscore (Foroutan et al., 2018).


compute_ssgsea() is called by hack_estimate() whereas all the three
methods are called by hack_sig()."><meta property="og:image" content="https://acare.github.io/hacksig/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hacksig</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hacksig.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/available-sigs.html">Available signatures</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Acare/hacksig/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Single sample scoring methods</h1>
      <small class="dont-index">Source: <a href="https://github.com/Acare/hacksig/blob/master/R/ss_methods.R" class="external-link"><code>R/ss_methods.R</code></a></small>
      <div class="d-none name"><code>ss_methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These are internal functions to compute single sample scores from a list of
gene signatures in three different ways:</p><ul><li><p><strong>combined z-score</strong> (<em>Lee et al., 2008</em>);</p></li>
<li><p><strong>single sample GSEA</strong> (<em>Barbie et al., 2009</em>);</p></li>
<li><p><strong>singscore</strong> (<em>Foroutan et al., 2018</em>).</p></li>
</ul><p><code>compute_ssgsea()</code> is called by <code><a href="hack_estimate.html">hack_estimate()</a></code> whereas all the three
methods are called by <code><a href="hack_sig.html">hack_sig()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compute_zscore</span><span class="op">(</span><span class="va">expr_data</span>, <span class="va">signatures</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">compute_ssgsea</span><span class="op">(</span></span>
<span>  <span class="va">expr_data</span>,</span>
<span>  <span class="va">signatures</span>,</span>
<span>  sample_norm <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>  rank_norm <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.25</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">compute_singscore</span><span class="op">(</span><span class="va">expr_data</span>, <span class="va">signatures</span>, direction <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-expr-data">expr_data<a class="anchor" aria-label="anchor" href="#arg-expr-data"></a></dt>
<dd><p>A normalized gene expression matrix (or data frame) with
gene symbols as row names and samples as columns.</p></dd>


<dt id="arg-signatures">signatures<a class="anchor" aria-label="anchor" href="#arg-signatures"></a></dt>
<dd><p>A named list of gene signatures.</p></dd>


<dt id="arg-sample-norm">sample_norm<a class="anchor" aria-label="anchor" href="#arg-sample-norm"></a></dt>
<dd><p>A character string specifying the type of normalization
affecting the <strong>single sample GSEA</strong> scores. Can be one of:</p><ul><li><p><code>"raw"</code> (default), obtain raw scores;</p></li>
<li><p><code>"separate"</code>, normalize raw scores in \([0, 1]\) across samples for
each signature separately.</p></li>
<li><p><code>"all"</code>, normalize raw scores both across samples and signatures.</p></li>
</ul></dd>


<dt id="arg-rank-norm">rank_norm<a class="anchor" aria-label="anchor" href="#arg-rank-norm"></a></dt>
<dd><p>A character string specifying how gene expression ranks should
be normalized in the <strong>single sample GSEA</strong> procedure. Valid choices are:</p><ul><li><p><code>"none"</code> (default), no rank normalization;</p></li>
<li><p><code>"rank"</code>, ranks are multiplied by <code>10000 / nrow(expr_data)</code>;</p></li>
<li><p><code>"logrank"</code>, normalized ranks are logged.</p></li>
</ul></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A numeric scalar. Exponent in the running sum of the <strong>single sample GSEA</strong>
score calculation which weighs the gene ranks. Defaults to \(\alpha = 0.25\).</p></dd>


<dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>A character string specifying the <strong>singscore</strong> computation
method depending on the direction of the signatures. Can be on of:</p><ul><li><p><code>"none"</code> (default), undirected signatures, that is you do not know whether
the genes are up- or down-regulated;</p></li>
<li><p><code>"up"</code>, all genes in the signature are supposed to be up-regulated;</p></li>
<li><p><code>"down"</code>, all genes in the signature are supposed to be down-regulated;</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with one row for each sample in <code>expr_data</code>, a column <code>sample_id</code>
indicating sample identifiers and one column for each input signature giving
single sample scores.</p>
    </div>
    <div class="section level2">
    <h2 id="algorithm">Algorithm<a class="anchor" aria-label="anchor" href="#algorithm"></a></h2>


<p>This section gives a brief explanation of how single sample scores are obtained
from different methods.</p><div class="section">
<h3 id="combined-z-score">Combined z-score<a class="anchor" aria-label="anchor" href="#combined-z-score"></a></h3>


<p>Gene expression values are centered by their mean value and scaled by their
standard deviation across samples for each gene (z-scores). Then, for each
sample and signature, corresponding z-scores are added up and divided by the
square root of the signature size (i.e. the number of genes composing a signature).</p>
<p>The combined z-score method is also implemented in the R package <code>GSVA</code>
(<em>Hänzelmann et al., 2013</em>).</p>
</div>

<div class="section">
<h3 id="single-sample-gsea">Single sample GSEA<a class="anchor" aria-label="anchor" href="#single-sample-gsea"></a></h3>


<p>For each sample, genes are ranked by expression value in increasing order and
rank normalization may follow (see argument <code>rank_norm</code>). Then, two probability-like
vectors are computed for each sample and signature:</p><ul><li><p>\(P_{in}\), the cumulative sum of weighted ranks divided by their total
sum for genes in the signature;</p></li>
<li><p>\(P_{out}\), the cumulative sum of ones (indicating genes not in the signature)
divided by the number of genes not in the signature.</p></li>
</ul><p>The single sample GSEA score is obtained by adding up the elements of the
vector difference \(P_{in} - P_{out}\).
Finally, single sample scores could be normalized either across samples or across
gene signatures and samples.</p>
<p>The single sample GSEA method is also implemented in the R package <code>GSVA</code>
(<em>Hänzelmann et al., 2013</em>).</p>
</div>

<div class="section">
<h3 id="singscore">Singscore<a class="anchor" aria-label="anchor" href="#singscore"></a></h3>


<p>For signatures whose genes are supposed to be up- or down-regulated, genes
are ranked by expression value in increasing or decreasing order, respectively.
For signatures whose direction is unknown, genes are ranked by absolute expression
in increasing order and are median-centered.
Enrichment scores are then computed for each sample and signature by averaging
gene ranks for genes in the signature.
Finally, normalized scores are obtained by subtracting the theoretical minimum
mean rank from the score and dividing by the difference between the theoretical
maximum and minimum mean ranks.</p>
<p>The <code>hacksig</code> implementation of this method works only with unidirectional (i.e.
all genes up- or down-regulated) and undirected gene signatures.
If you want to get single sample scores for bidirectional gene signatures (i.e.
signatures composed of both up- and down-regulated genes), please use the R
package <code>singscore</code> (<em>Foroutan et al., 2018</em>).</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Barbie, D. A., Tamayo, P., Boehm, J. S., Kim, S. Y., Moody, S. E., Dunn, I. F.,
Schinzel, A. C., Sandy, P., Meylan, E., Scholl, C., Fröhling, S., Chan, E. M.,
Sos, M. L., Michel, K., Mermel, C., Silver, S. J., Weir, B. A., Reiling, J. H.,
Sheng, Q., Gupta, P. B., … Hahn, W. C. (2009). Systematic RNA interference
reveals that oncogenic KRAS-driven cancers require TBK1. <em>Nature</em>, 462(7269),
108–112. <a href="https://doi.org/10.1038/nature08460" class="external-link">doi:10.1038/nature08460</a>
.</p>
<p>Foroutan, M., Bhuva, D. D., Lyu, R., Horan, K., Cursons, J., &amp;
Davis, M. J. (2018). Single sample scoring of molecular phenotypes.
<em>BMC bioinformatics</em>, 19(1), 404. <a href="https://doi.org/10.1186/s12859-018-2435-4" class="external-link">doi:10.1186/s12859-018-2435-4</a>
.</p>
<p>Hänzelmann, S., Castelo, R., &amp; Guinney, J. (2013). GSVA: gene set variation
analysis for microarray and RNA-seq data. <em>BMC bioinformatics</em>, 14, 7.
<a href="https://doi.org/10.1186/1471-2105-14-7" class="external-link">doi:10.1186/1471-2105-14-7</a>
.</p>
<p>Lee, E., Chuang, H. Y., Kim, J. W., Ideker, T., &amp; Lee, D. (2008). Inferring
pathway activity toward precise disease classification.
<em>PLoS computational biology</em>, 4(11), e1000217.
<a href="https://doi.org/10.1371/journal.pcbi.1000217" class="external-link">doi:10.1371/journal.pcbi.1000217</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="hack_sig.html">hack_sig()</a></code>, <code><a href="hack_estimate.html">hack_estimate()</a></code>, <code>GSVA::gsva()</code>, <code>singscore::multiScore()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrea Carenzo, Loris De Cecco, Federico Pistore.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

